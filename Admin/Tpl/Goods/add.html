<meta charset="utf-8" />
<link href="__ROOT__/Public/Admin/css/list.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="__ROOT__/Public/Admin/css/jquery.bigautocomplete.css" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/Home/js/jquery-1.8.3.min.js" ></script>
<script src="__ROOT__/Public/Admin/js/formvalidator/formValidator-4.1.1.js" type="text/javascript" charset="UTF-8"></script> 


<link rel="stylesheet" href="__ROOT__/Public/Admin/css/demo.css" type="text/css">
<link rel="stylesheet" href="__ROOT__/Public/Admin/css/zTreeStyle.css" type="text/css">
<script type="text/javascript" src="__ROOT__/Public/Admin/js/jquery.ztree.core-3.5.js"></script>
<script type="text/javascript" src="__ROOT__/Public/Admin/js/jquery.ztree.excheck-3.5.js"></script>

<script src="__ROOT__/Public/Admin/js/DatePicker/WdatePicker.js" type="text/javascript"></script> 



<div class="currentposition">
    <div>{$cur_menu} > {$cur_title}</div>
</div>
<div class="addclass">
    <div class="addtopheight">&nbsp;</div>
    <form method="POST" onsubmit="return check_from()"   ENCTYPE="multipart/form-data" action="__URL__/add_data" />
    <!-- <input type="hidden" name="shop_id_arr" id="shop_all" value=""/>-->
    <table width="100%" class="addsearchClass" border="0" cellpadding="0" cellspacing="0" >   
        <tr>
            <td width="10%" height="30" align="right" class="left_txt2"><span class="must">*</span>商品名称：</td>
            <td width="80%" >
                <div style="float:left;">
                    <input type="text" size="50" name="goods_name"  />
                </div>
            </td>
        </tr>
        <tr>
            <td width="10%" height="30" align="right" class="left_txt2"><span class="must">*</span>商品运费：</td>
            <td width="80%" >
                <div style="float:left;">
                    <input type="text" size="50" name="fee_price"  />
                </div>
            </td>
        </tr>
        <tr>
            <td width="10%" height="60" align="right" class="left_txt2"><span class="must">*</span>新增店铺：</td>
            <td width="80%" >
                <div id="insert_shop_list"></div>
                <div>
                    输入城市：
                    <input type="text" id="keyword_two" value="" name="" style="width:100px;"/>

                    <input type="hidden"  name='shop_id' id="shop_id"  style="width:200px;" value="">
                    <input type="text" id="search"  value='' name=""/>
                </div>

            </td>
        </tr>
        <tr>
            <td width="10%" height="30" align="right" class="left_txt2"></td>
            <td width="80%" ><div style="float:left;"></div><div class="search_tips"></div></td>
        </tr>
        <tr>
            <td width="10%" height="30" align="right" class="left_txt2"><span class="must">*</span>主图：</td>
            <td width="80%" >
                <div>
                    <input type="file" name="file[]" id="file1"/>&nbsp;

                </div>
            </td>
        </tr>

        <tr>
            <td width="10%" height="30" align="right" class="left_txt2">产品详细图：</td>
            <td width="80%" >
                <div class="add_img"><input type="file"  name="product_images[]"/><a href="javascript:void(0)" class="add_product_img">添加</a></div>
            </td>
        </tr>

        <tr>
            <td height="10" align="right" class="left_txt2">市场价：</td>
            <td><input type="text"  name="market_price" size="60"/></td>
        </tr>
        <tr>
            <td width="10%" height="30" align="right" class="left_txt2">本店价：</td>
            <td width="80%" ><div style="float:left;"><input type="text" name="shop_price" size="3" /></div></td>
        </tr>
        <tr>
            <td width="10%" height="30" align="right" class="left_txt2">库存：</td>
            <td width="80%" ><div style="float:left;"><input type="text" name="goods_stock" size="3"/></div></td>
        </tr>
        <tr>
            <td width="10%" height="30" align="right" class="left_txt2">属性：</td>
            <td width="80%" >
        <foreach name="goods_attr" item="goods_attr_1" key="k">
            <div style="line-height: 30px;">
                <span>{$k}</span>
                <foreach name="goods_attr_1" item="goods_attr_2">
                    <span style="margin-left:10px;color: #aeaeae">
                        <input type="checkbox" name="attr[]" value="{$goods_attr_2.id}"/>{$goods_attr_2.goods_attr_type_value}
                    </span>
                </foreach> 
            </div>    
        </foreach> 
        </td>
        </tr>
        <tr>
            <td height="10" align="right" class="left_txt2">描述：</td>
            <td><textarea name="goods_desc" class="textarea" cols="70" rows="5" > </textarea></td>
        </tr>
        <tr>
            <td height="10" align="right" class="left_txt2">状态：</td>
            <td>
                <input type="radio" name="is_on_sale" value="1" id="status" checked/>上架
                <input type="radio" name="is_on_sale" value="0" id="status"/>不上架&nbsp;&nbsp;&nbsp;&nbsp;
            </td>
        </tr>
        <tr>
            <td height="10" align="right" class="left_txt2">活动时间：</td>
            <td><input type="text" id="create_time" onClick="WdatePicker()" size="11" class="Wdate" name="create_time" value="" />至
                <input type="text" id="update_time" onClick="WdatePicker()" size="11" class="Wdate" name="update_time" value="" /></td>
        </tr>
        <tr>
            <td width="10%" height="30" align="right" class="left_txt2">颜色：</td>
            <td width="80%" ><div style="float:left;"><input type="text" class="input-100" name="color[]" /></div><span onclick="addtr(this)">+</span></td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="addoperation">
                    <input type="submit" class="buttonsave" value="保存" name="sub_authority" />
                    &nbsp;
                    <input type="reset" class="buttoncancel" value="取消" onclick="javascript:history.go(-1);" name="B12" />
                </div>
            </td> 
        </tr>
    </table>
</form>
<div>&nbsp;</div>
<div id="menuContent" class="menuContent" style="display:none; position: absolute;">
    <ul id="treeDemo" class="ztree"></ul>
</div>
</div>
<script type="text/javascript">
    function check_from() {
        if ($("#goods_name").val() == "") {
            $("#goods_name").css({"background-color": "#fbe2e2"}).focus();
            return false;
        }
        if ($("input[name='market_price']").val() == "") {
            $("input[name='market_price']").css({"background-color": "#fbe2e2"}).focus();
            return false;
        }
        if ($("input[name='shop_price']").val() == "") {
            $("input[name='shop_price']").css({"background-color": "#fbe2e2"}).focus();
            return false;
        }
        if ($(".textarea").val() == "") {
            $(".textarea").css({"background-color": "#fbe2e2"}).focus();
            return false;
        }
    }

</script>
<script>
    /* 查询商家  */
    $(function() {
        $("#search").on("keyup", function() {
            var keywords = $(this).val();
            var keyword_two = $('#keyword_two').val();
            if (keywords != "")
            {
                $.ajax({
                    type: 'POST',
                    dataType: 'json',
                    async: false,
                    url: '__APP__/adminuser/get_shop?keywords_two=' + keyword_two,
                    data: {'keywords': keywords},
                    success: function(data) {
                        str = '<ul>';
                        for (i = 0; i < data.length; i++) {
                            str += '<li kid=' + data[i].id + ' sname=' + data[i].name + '><a href="javascript:;" id=' + data[i].id + '">';
                            str += '商铺名： '
                            str += data[i].name;
                            str += "&nbsp&nbsp&nbsp&nbsp&nbsp";
                            str += '地址：'
                            str += data[i].addr;
                            str += '</a></li>';
                        }
                        str += '</ul>';
                        $(".search_tips").html(str);

                        $(".search_tips ul li").click(function() {
                            var _shop_list = '';
                            var key_id = $(this).text();
                            var all_id = '';
                            $(this).attr('kid');
                            //alert($(this).attr('kid'));
                            //$('#shop_id').val($(this).attr('kid'));
                            //$('#search').val($(this).text());
                            all_id = $('#shop_all').val();
                            if (all_id) {
                                all_id = all_id + $(this).attr('kid') + '/';
                                $('#shop_all').val(all_id);
                            } else {
                                all_id = $(this).attr('kid') + '/';
                                $('#shop_all').val(all_id);

                            }
                            _shop_list = '<div id="all_shop"><input type="hidden" name="arr_shop_id[]" value="' + $(this).attr('kid') + '">' + $(this).attr('sname') + '&nbsp;<a href="javascript:void(0)" class="del_shop">删除</a>&nbsp;</div>';
                            $("#insert_shop_list").append(_shop_list);
                            $(".search_tips").css('display', 'none');
                        });

                        $(".del_shop").live('click', function() {
                            $(this).parent().remove();
                        })


                        $(".search_tips").show();
                        //$('.other_search').hide();

                    }




                });
            }

        });

        /* $('#search_tips').live('click',function(){
         alert($(this).find('a:last').val());
         
         }) */

        $(".del_shop").click(function() {
            $(this).parent().remove();
        })


        $(".add_product_img").click(function() {
            $(this).parent().after('<div class="add_img"><input type="file" name="product_images[]"/><a href="javascript:void(0)" class="del_product_img">删除</a></div>');
        })

        $(".add_color").click(function() {
            $(this).parent().after('<div class="add_product_color"><input type="text" style="width: 80px;" name="product_color[]"/><a href="javascript:void(0)" class="del_color">删除</a></div>');
        })

        $(".del_color").live('click', function() {
            $(this).parent().remove();
        })


        $(".del_product_img").live('click', function() {
            $(this).parent().remove();
        })

        $(".del_color").live('click', function() {
            $(this).parent().remove();
        })


    })
</script>
<script>
    function addtr(o) {
        var html = '<tr><td align="right" width="10%" height="30" class="left_txt2">颜色：</td><td width="80%"><div style="float:left;"><input type="text" name="color[]" class="input-100"></div><span style="margin-right:10px" onclick="addtr(this)">+</span><span onclick="removetr(this)">-</span></td></tr>';
        $(o).parent().parent().after(html);
    }
    function removetr(o) {
        $(o).parent().parent().remove();
    }
</script>